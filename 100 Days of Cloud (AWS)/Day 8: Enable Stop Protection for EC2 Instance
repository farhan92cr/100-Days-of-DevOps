Day 8: Enable Stop Protection for EC2 Instance:

As part of the migration, there were some components added to the AWS account. Team created one of the EC2 instances where they need to make some changes now.

There is an EC2 instance named datacenter-ec2 under us-east-1 region, enable the stop protection for this instance.



Use below given AWS Credentials: (You can run the showcreds command on aws-client host to retrieve these credentials)

Console URL	https://104982956445.signin.aws.amazon.com/console?region=us-east-1
Username	kk_labs_user_345538
Password	Os%EmeaAC5Ir
Start Time	Wed Dec 03 05:47:15 UTC 2025
End Time	Wed Dec 03 06:47:15 UTC 2025

Notes:

Create the resources only in us-east-1 region.

To display or hide the terminal of the AWS client machine, you can use the expand toggle button as shown below:


SOLUTION:


üõ°Ô∏è Day 8 Lab: Enabling Stop Protection for EC2 Instance
üìñ Lab Explanation
Today, we're enabling Stop Protection for an EC2 instance. This is a safety feature that prevents accidental stopping or termination of critical instances. It's like putting a "Do Not Disturb" sign on important servers.

üîç Key Terms Defined
Stop Protection
What: A safety feature that prevents accidental stopping/termination

Purpose: Protects critical instances from human error or automated processes

Effect: Requires explicit disablement before stopping/terminating

Instance Stop vs Termination
Stop: Instance is shut down but persists (can be started again)

Termination: Instance is permanently deleted

Stop Protection: Prevents both actions

Instance State
Running: Active and operational

Stopped: Shut down but can be restarted

Terminated: Permanently deleted

üöÄ Benefits & Why We Use Stop Protection
üîí Security & Safety Benefits
Accident Prevention: Avoids accidental shutdown of production instances

Change Control: Enforces proper procedures for changes

Critical Systems: Protects databases, payment systems, etc.

üí° Operational Benefits
Disaster Prevention: Prevents data loss from accidental termination

Compliance: Meets audit requirements for change management

Team Safety: Multiple team members can't accidentally stop instances

üéØ When to Enable Stop Protection
Production Servers: Critical business applications

Database Servers: Where data loss would be catastrophic

Compliance Requirements: Regulated industries (finance, healthcare)

Long-running Processes: Jobs that must not be interrupted

‚ö†Ô∏è Important Considerations
Not Foolproof: Can be disabled by authorized users

Cost: Doesn't prevent charges (instance still runs)

Emergency Access: Keep credentials secure for emergencies

üõ†Ô∏è Step-by-Step Solution
Method: AWS Management Console
Login to AWS Console

bash
# Use the provided credentials:
URL: https://104982956445.signin.aws.amazon.com/console?region=us-east-1
Username: kk_labs_user_345538
Password: Os%EmeaAC5Ir
Region: us-east-1 (VERIFY THIS!)
Navigate to EC2 Dashboard

Go to Services ‚Üí EC2

In left sidebar, click "Instances"

Locate the Instance

Find instance named datacenter-ec2

If not visible, check:

Correct region (us-east-1)

Search by name tag

Filter by tag: Name=datacenter-ec2

Enable Stop Protection

Select the datacenter-ec2 instance

Click Actions ‚Üí Instance settings ‚Üí Change termination protection

Termination protection dialog appears:

Check "Enable"

Note: AWS calls it "termination protection" but it prevents both stop and termination

Click "Save"

Verify Protection is Enabled

Select the instance

Go to Details tab

Look for Termination protection field

Should show: Enabled

Also visible in Description panel at bottom

Test Protection (Optional - DO NOT ACTUALLY DO)

Try to stop instance: Should get error message

Try to terminate instance: Should get error message

Both will fail until protection is disabled

üìã What We Configured
Instance: datacenter-ec2

Feature: Stop/Termination Protection

Status: Enabled

Effect: Cannot stop or terminate without disabling protection first

üîß Alternative Method: AWS CLI
bash
# Enable termination protection
aws ec2 modify-instance-attribute \
  --instance-id i-xxxxxxxx \
  --disable-api-termination "{\"Value\": true}"

# Check current status
aws ec2 describe-instance-attribute \
  --instance-id i-xxxxxxxx \
  --attribute disableApiTermination
üõ°Ô∏è Additional Protection Features
Termination Protection (What we enabled)
Prevents accidental stop/termination

Must be disabled before stopping

Instance State Change Guard
Additional layer for state transitions

IAM Policies
Control who can disable protection

Example policy to prevent disabling:

json
{
  "Effect": "Deny",
  "Action": "ec2:ModifyInstanceAttribute",
  "Resource": "*",
  "Condition": {
    "StringEquals": {
      "ec2:Attribute": "disableApiTermination"
    }
  }
}
‚ö†Ô∏è Important Notes
Not Backup: Protection ‚â† backup - still need regular backups

Charges Apply: Instance continues to accrue charges

Emergency Access: Keep admin credentials secure

Disable Process:

Disable termination protection

Stop/terminate instance

Re-enable if needed for new instance

üîê Security Best Practices
Enable for all production instances

Use IAM policies to restrict who can disable

Document procedures for emergency shutdowns

Monitor alerts for protection disable events

üéâ Congratulations!
You've completed Day 8! You've added an important safety layer to protect critical EC2 instances from accidental shutdowns or deletions.

