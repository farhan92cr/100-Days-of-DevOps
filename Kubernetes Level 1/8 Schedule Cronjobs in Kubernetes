The Nautilus DevOps team is setting up recurring tasks on different schedules. Currently, they're developing scripts to be executed periodically. To kickstart the process, they're creating cron jobs in the Kubernetes cluster with placeholder commands. Follow the instructions below:



Create a cronjob named datacenter.


Set Its schedule to something like */2 * * * *. You can set any schedule for now.


Name the container cron-datacenter.


Utilize the nginx image with latest tag (specify as nginx:latest).


Execute the dummy command echo Welcome to xfusioncorp!.


Ensure the restart policy is OnFailure.


Note: The kubectl utility on jump_host is configured to work with the kubernetes cluster.



SOlution:

Explanation of the Lab
This lab introduces CronJobs - Kubernetes resources for running scheduled tasks, similar to Linux cron jobs but for containerized applications.

New Terms Explained:
CronJob:

What: A Kubernetes resource that runs jobs on a time-based schedule

Why use it: For periodic tasks like backups, reports, cleanup, maintenance

Real-world analogy: Like setting up an automatic sprinkler system that runs every day at 6 AM

Key Features:

Scheduled execution: Runs jobs at specified times

Job history: Keeps track of successful and failed jobs

Parallelism control: Manages how many jobs can run concurrently

Retry logic: Automatically retries failed jobs

Step-by-Step Solution
Step 1: Create the CronJob YAML file
bash
cat > datacenter-cronjob.yaml << EOF
apiVersion: batch/v1
kind: CronJob
metadata:
  name: datacenter
spec:
  schedule: "*/2 * * * *"   # Every 2 minutes
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: cron-datacenter
            image: nginx:latest
            command: ["/bin/sh"]
            args: ["-c", "echo Welcome to xfusioncorp!"]
          restartPolicy: OnFailure
EOF
Step 2: Apply the CronJob
bash
kubectl apply -f datacenter-cronjob.yaml
Step 3: Verification
bash
# Check CronJob status
kubectl get cronjob datacenter

# Check jobs created by the CronJob
kubectl get jobs

# Check pods created by the jobs
kubectl get pods

# Get detailed information
kubectl describe cronjob datacenter
Step 4: Wait and monitor (optional)
bash
# Wait for the first execution (up to 2 minutes)
sleep 120

# Check if jobs were created
kubectl get jobs --watch
Real-World Analogy â°
Think of this CronJob like a Scheduled Office Announcement System:

yaml
apiVersion: batch/v1
kind: CronJob              # "Office Announcement Scheduler" ðŸ“¢
metadata:
  name: datacenter         # "Daily Welcome Announcement"
spec:
  schedule: "*/2 * * * *"  # "Make announcement every 2 minutes" â°
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: cron-datacenter    # "Announcement Speaker"
            image: nginx:latest      # "Using the office PA system"
            command: ["/bin/sh"]
            args: ["-c", "echo Welcome to xfusioncorp!"]  # "Announcement text"
          restartPolicy: OnFailure   # "Retry if announcement fails"
Schedule Explanation:
*/2 * * * * = Every 2 minutes

Format: minute hour day month day-of-week

*/2 = every 2 minutes

* = every hour, every day, every month, every day of week

Expected Output:
text
NAME         SCHEDULE      SUSPEND   ACTIVE   LAST SCHEDULE   AGE
datacenter   */2 * * * *   False     0        <none>          30s
After 2 minutes, you should see:

text
NAME                        COMPLETIONS   DURATION   AGE
datacenter-1234567890       1/1           5s         30s
And pods with completed status:

text
NAME                              READY   STATUS      RESTARTS   AGE
datacenter-1234567890-abcde       0/1     Completed   0          45s
Key Learning:
CronJobs are perfect for scheduled maintenance tasks

They create Job resources which in turn create Pods

The restart policy ensures reliability

Schedule uses standard cron format

Your automated welcome message system is now set up! ðŸŽ‰



