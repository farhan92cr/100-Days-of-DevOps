17 Create DynamoDB Table Using Terraform:

The Nautilus DevOps team needs to set up a DynamoDB table for storing user data. They need to create a DynamoDB table with the following specifications:

1) The table name should be datacenter-users.

2) The primary key should be datacenter_id (String).

3) The table should use PAY_PER_REQUEST billing mode.

Use Terraform to create this DynamoDB table. The Terraform working directory is /home/bob/terraform. Create the main.tf file (do not create a different .tf file) to create the DynamoDB table.

Note: Right-click under the EXPLORER section in VS Code and select Open in Integrated Terminal to launch the terminal.


SOLUTION:

Lab 17: Create DynamoDB Table Using Terraform
Simple Explanation
This lab teaches you to create a DynamoDB table, which is AWS's fully managed NoSQL database service. You're creating a table to store user data with a simple primary key structure and pay-per-request billing.

Key Terms
DynamoDB: AWS managed NoSQL database service

Primary Key: Unique identifier for items in the table

PAY_PER_REQUEST: Billing mode where you pay per read/write operation

Hash Key: The primary key that uniquely identifies each item

NoSQL: Non-relational database (no fixed schema, no SQL queries)

Benefits and Use Cases
Serverless: No servers to manage, scales automatically

High Performance: Single-digit millisecond latency

Flexible Schema: Store different attributes for different items

Cost-effective: Pay only for what you use with PAY_PER_REQUEST

Step-by-Step Solution
Step 1: Open Terminal in VS Code

Right-click in EXPLORER â†’ "Open in Integrated Terminal"

Step 2: Navigate to Terraform Directory

bash
cd /home/bob/terraform
Step 3: Add DynamoDB Table to main.tf File
Add this DynamoDB resource to your existing main.tf:

hcl
# Create DynamoDB Table
resource "aws_dynamodb_table" "datacenter_users" {
  name         = "datacenter-users"
  billing_mode = "PAY_PER_REQUEST"
  hash_key     = "datacenter_id"

  # Define the attribute for hash key
  attribute {
    name = "datacenter_id"
    type = "S"  # S = String type
  }

  tags = {
    Name        = "datacenter-users"
    CreatedBy   = "Terraform"
    Purpose     = "User data storage"
  }
}
Step 4: Initialize Terraform (if needed)

bash
terraform init
Step 5: Plan the Infrastructure

bash
terraform plan
Step 6: Apply the Configuration

bash
terraform apply
Type yes when prompted

Step 7: Verify the DynamoDB Table

bash
# Check if table was created
terraform show | grep -A10 "aws_dynamodb_table.datacenter_users"

# Or use AWS CLI
aws dynamodb describe-table --table-name datacenter-users
What This Creates:
DynamoDB Table named "datacenter-users"

Primary Key: datacenter_id (String type, also called hash key)

Billing Mode: PAY_PER_REQUEST (on-demand pricing)

Empty Table: No data yet, just the table structure

Complete Example with Additional Features (Optional):
hcl
resource "aws_dynamodb_table" "datacenter_users" {
  name         = "datacenter-users"
  billing_mode = "PAY_PER_REQUEST"
  hash_key     = "datacenter_id"

  attribute {
    name = "datacenter_id"
    type = "S"
  }

  # Optional: Add global secondary index
  global_secondary_index {
    name            = "UserEmailIndex"
    hash_key        = "email"
    projection_type = "ALL"
    read_capacity   = 5
    write_capacity  = 5
  }

  # Optional: Enable point-in-time recovery for backups
  point_in_time_recovery {
    enabled = true
  }

  # Server-side encryption
  server_side_encryption {
    enabled = true
  }

  tags = {
    Name        = "datacenter-users"
    Environment = "Lab"
  }
}
Expected Output:
text
aws_dynamodb_table.datacenter_users:
  id = datacenter-users
  arn = arn:aws:dynamodb:us-east-1:123456789012:table/datacenter-users
  name = datacenter-users
  billing_mode = PAY_PER_REQUEST
  hash_key = datacenter_id
  read_capacity = 0
  write_capacity = 0
  stream_enabled = false
  table_class = STANDARD
  tags = { CreatedBy = "Terraform", Name = "datacenter-users", Purpose = "User data storage" }
Key Components Explained:
name = "datacenter-users": Table name as required

billing_mode = "PAY_PER_REQUEST": On-demand pricing (no capacity planning)

hash_key = "datacenter_id": Primary key attribute

attribute block: Defines the data type of the key (S = String)

PAY_PER_REQUEST vs PROVISIONED:
Feature	PAY_PER_REQUEST	PROVISIONED
Billing	Pay per read/write	Pay for provisioned capacity
Capacity	Auto-scales	Fixed capacity you specify
Best For	Variable/unpredictable traffic	Predictable, steady traffic
Cost	More expensive per operation	Cheaper for high steady usage
DynamoDB Data Types:
S: String

N: Number

B: Binary

BOOL: Boolean

SS: String Set

NS: Number Set

BS: Binary Set

Example Item Structure:
json
{
  "datacenter_id": "DC-001",
  "user_name": "john_doe",
  "email": "john@example.com",
  "department": "Engineering",
  "created_at": "2024-01-15"
}
Use Cases for This Table:
User Profiles: Store user information by datacenter ID

Session Storage: User sessions for web applications

Configuration Data: Application configuration settings

Audit Logs: User activity logs

Important Notes:
Case Sensitive: Table names are case-sensitive

No Schema: You can add any attributes to items later

Fast Lookups: Primary key enables fast retrieval of items

Single Table Design: AWS recommends single table design for related data

Your Infrastructure Now Has:
âœ… Key pairs

âœ… Security groups

âœ… VPCs

âœ… Elastic IP

âœ… EC2 instance

âœ… AMI

âœ… EBS Volume

âœ… EBS Snapshot

âœ… CloudWatch Alarm

âœ… S3 Bucket

âœ… IAM User

âœ… IAM Group

âœ… IAM Policy

âœ… DynamoDB Table (NoSQL database)

Ready for Lab 18! ðŸš€

